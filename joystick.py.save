import time
import pygame
import sys


class ps3:
	def __init__(self,port):
		self.port=port
		pygame.init()
		pygame.joystick.init()
		self.joystick1 = pygame.joystick.Joystick(port)

	def connect(self):
		self.joystick1.init()

	def pump(self):
		pygame.event.pump()

	def get_buttons(self):
		self.pump()
		# for x in range(self.joystick1.get_numbuttons()):
		# 	print str(x) +": " + str(self.joystick1.get_button(x))
		square = 15
		cross = 14
		right_shoulder =11
		left_shoulder=10
		right_trigger =9
		left_trigger=8

		push_left=1
		push_right=2

		push_left_on=False
		push_right_on=False
		cross_on=False
		circle_on=False
		square_on=False
		right_shoulder_on=False
		left_shoulder_on=False
		right_trigger_on=False
		left_trigger_on=False

		if(self.joystick1.get_button(square)==1):
			square_on=True
		if(self.joystick1.get_button(cross)==1):
			cross_on=True

		if self.joystick1.get_button(left_shoulder)==1:
			left_shoulder_on=True
		if(self.joystick1.get_button(right_trigger)==1):
			right_trigger_on=True
		if self.joystick1.get_button(left_trigger)==1:
			left_trigger_on=True

		if(self.joystick1.get_button(push_left)==1):
			push_left_on=True
		if self.joystick1.get_button(push_right)==1:
			push_right_on=True
		# elif joystick1.get_button(right_trigger):
		# 	print "Close gripper"
		# elif joystick1.get_button(left_trigger):
		# 	print "Open gripper"
		return {
			'right_shoulder':right_shoulder_on, 
			'left_shoulder':left_shoulder_on,
			'right_trigger':right_trigger_on,
			'left_trigger':left_trigger_on,
			'push_left':push_left_on, 
			'push_right':push_right_on,
			'square':square_on,
			'cross':cross_on,
			}

if(__name__=='__main__'):
	ps=ps3(0)
	ps.connect()
	while(True):
		ps.pump()
		b=ps.get_buttons()
		print b
